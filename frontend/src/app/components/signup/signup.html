<form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="signup-form rounded-3xl bg-white shadow-md flex flex-col w-[400px] p-10">
  <h1 class="text-2xl mb-4 font-bold">Sign up</h1>

  <!-- Message global d'erreur (backend) -->
  <div *ngIf="errorMessage" class="bg-red-100 text-red-600 p-3 rounded-md mb-5 text-sm">
    {{ errorMessage }}
  </div>

  <!-- NAME -->
  <div class="relative w-full mb-3">
    <input 
      type="text"
      id="name"
      formControlName="name"
      class="peer p-2 w-full bg-white rounded border border-1 border-zinc-400 focus:outline-none focus:border-blue-500"
    />
    <label 
      for="name"
      [class]="'absolute left-2 transition-all duration-200 bg-white px-1 ' +
              (f['name'].value?.length > 0 ? '-top-3 text-xs text-blue-500' : 'top-2 text-base text-gray-400') +
              ' peer-focus:-top-3 peer-focus:text-xs peer-focus:text-blue-500'">
      Name
    </label>
    <div *ngIf="f['name'].touched && f['name'].invalid" class="text-red-500 text-sm mt-1">
      <div *ngIf="f['name'].errors?.['required']">Le nom est obligatoire.</div>
      <div *ngIf="f['name'].errors?.['minlength']">Minimum 2 caractères.</div>
    </div>
  </div>

  <!-- FIRST NAME -->
  <div class="relative w-full mb-3">
    <input 
      type="text"
      id="first_name"
      formControlName="first_name"
      class="peer p-2 w-full bg-white rounded border border-1 border-zinc-400 focus:outline-none focus:border-blue-500"
    />
    <label 
      for="first_name"
      [class]="'absolute left-2 transition-all duration-200 bg-white px-1 ' +
              (f['first_name'].value?.length > 0 ? '-top-3 text-xs text-blue-500' : 'top-2 text-base text-gray-400') +
              ' peer-focus:-top-3 peer-focus:text-xs peer-focus:text-blue-500'">
      First name
    </label>
    <div *ngIf="f['first_name'].touched && f['first_name'].invalid" class="text-red-500 text-sm mt-1">
      <div *ngIf="f['first_name'].errors?.['required']">Le prénom est obligatoire.</div>
      <div *ngIf="f['first_name'].errors?.['minlength']">Minimum 2 caractères.</div>
    </div>
  </div>

  <!-- USERNAME -->
  <div class="relative w-full mb-3">
    <input 
      type="text"
      id="username"
      formControlName="username"
      class="peer p-2 w-full bg-white rounded border border-1 border-zinc-400 focus:outline-none focus:border-blue-500"
    />
    <label 
      for="username"
      [class]="'absolute left-2 transition-all duration-200 bg-white px-1 ' +
              (f['username'].value?.length > 0 ? '-top-3 text-xs text-blue-500' : 'top-2 text-base text-gray-400') +
              ' peer-focus:-top-3 peer-focus:text-xs peer-focus:text-blue-500'">
      Username
    </label>
    <div *ngIf="f['username'].touched && f['username'].invalid" class="text-red-500 text-sm mt-1">
      <div *ngIf="f['username'].errors?.['required']">Le nom d’utilisateur est obligatoire.</div>
      <div *ngIf="f['username'].errors?.['minlength']">Minimum 3 caractères.</div>
    </div>
  </div>

  <!-- PASSWORD -->
  <div class="relative w-full mb-3">
    <input 
      [type]="isShow ? 'text' : 'password'"
      id="password"
      formControlName="password"
      class="peer p-2 w-full rounded border border-1 border-zinc-400 focus:outline-none focus:border-blue-500"
    />
    <label 
      for="password"
      [class]="'absolute left-2 transition-all duration-200 bg-white px-1 ' +
              (f['password'].value?.length > 0 ? '-top-3 text-xs text-blue-500' : 'top-2 text-base text-gray-400') +
              ' peer-focus:-top-3 peer-focus:text-xs peer-focus:text-blue-500'">
      Password
    </label>
    <i 
      (click)="toggleShowPassword()" 
      class="absolute right-3 top-3 cursor-pointer"
      [ngClass]="isShow ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'">
    </i>
    <div *ngIf="f['password'].touched && f['password'].invalid" class="text-red-500 text-sm mt-1">
      <div *ngIf="f['password'].errors?.['required']">Le mot de passe est obligatoire.</div>
      <div *ngIf="f['password'].errors?.['minlength']">Minimum 6 caractères.</div>
    </div>
  </div>

  <button type="submit" class="bg-blue-500 cursor-pointer flex justify-center items-center rounded-xl p-3 mb-3 text-white" [disabled]="signup">
    <!-- Sign up -->
    @if(!signup) {
      Sign up
    } @else {
      <div class="animate-spin rounded-full h-6 w-6 border-4 border-white border-t-transparent"></div>
    }
  </button>

  <p>
    Already have an account ?
    <a class="text-blue-500" [routerLink]="['/login']">Sign in</a>
  </p>
</form>
