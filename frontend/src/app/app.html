<div class="search h-[3rem] mx-8 flex justify-end items-center my-5 rounded-xl" *ngIf="connected">
    <div class="me-5 bg-white px-3 rounded-3xl shadow-md">
      <input type="text" class="me-3 py-2 rounded-3xl" placeholder="Search...">
      <i class="fa-solid fa-magnifying-glass"></i>
    </div>
  </div>
  
  <div class="flex flex-row h-[32rem]" *ngIf="connected; else loginTemplate">
    <div class="p-0 flex flex-col justify-between aside basis-1/7 ms-8 rounded-xl bg-white shadow-md">
      <ul class="mt-5 flex flex-col">
        <a [routerLink]="['/dashboard']" routerLinkActive="bg-zinc-100" class="px-3 py-2 hover:bg-zinc-50 w-[100%] inline-block">
          <li class="flex items-center">
            <i class="fa-regular fa-house me-3"></i>
            <span>Dashboard</span>
          </li>
        </a>

        <a [routerLink]="['/stats']" routerLinkActive="bg-zinc-100" class="px-3 py-2 hover:bg-zinc-50 w-[100%] inline-block">
          <li class="flex items-center">
            <i class="fa-solid fa-chart-line me-3"></i>
            <span>Statistics</span>
          </li>
        </a>

        <a [routerLink]="['/transactions']" routerLinkActive="bg-zinc-100" class="px-3 py-2 hover:bg-zinc-50 w-[100%] inline-block">
          <li class="flex items-center">
            <i class="fa-regular fa-chart-bar me-3"></i>
            <span>Transaction</span>
          </li>
        </a>
      </ul>

      <div class="px-3 py-2 items-center flex flex-row justify-between">
        <div class="flex items-center">
          <div
            style="width: 30px; height: 30px; border-radius: 50%;"
            class="profile flex justify-center items-center bg-blue-500 me-3"
          >
            <i class="fa-regular text-white fa-user"></i>
          </div>
      
          <span class="block">{{ user?.username | titlecase }}</span>
        </div>
      
        <!-- Dropdown -->
        <div class="relative menu-container" (click)="toggleMenu()" tabindex="0">
          <button class="text-gray-700 hover:text-gray-900">
            <i class="fa-solid fa-ellipsis-vertical cursor-pointer"></i>
          </button>
      
          <div
            *ngIf="isMenuOpen"
            class="absolute right-0 bottom-full mb-2 w-40 bg-white rounded-md shadow-lg z-50
                   transform origin-bottom transition-all duration-200 ease-out
                   animate-slide-up"
          >
            <ul class="py-1 text-sm text-gray-700">
              <li>
                <a
                  routerLink="/profile"
                  class="block px-4 py-2 hover:bg-gray-100"
                >
                  <i class="fa-regular fa-user me-2 text-xs"></i> Profil
                </a>
              </li>
              <li>
                <button
                  (click)="logout()"
                  class="w-full text-left block px-4 py-2 hover:bg-gray-100 cursor-pointer"
                >
                  <i class="fa-solid fa-right-from-bracket me-2 text-xs"></i> Loggout
                </button>
              </li>
              <li>
                <button
                  (click)="openModal(true)"
                  class="w-full text-left block px-4 py-2 hover:bg-gray-100 text-red-600 cursor-pointer"
                >
                  <i class="fa-solid fa-user-slash me-2 text-xs"></i> Delete account
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>      
    </div>
  
    <div class="main basis-6/7 mx-8 rounded-xl">
      <router-outlet></router-outlet>
    </div>
  </div>
  
  <ng-template #loginTemplate>
    <router-outlet></router-outlet>
  </ng-template>

  
  <!-- Modal (géré par Angular CDK Overlay) -->
  <ng-template #modalTemplate>
    <div class="relative bg-white rounded-xl shadow-lg w-[90%] md:w-[400px] p-6">
      <button
        type="button"
        (click)="closeModal()"
        class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 cursor-pointer"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
  
      <div class="flex gap-2 mb-3 items-center">
        <i class="fa-solid text-xl fa-triangle-exclamation text-red-500"></i>
        <h2 class="text-lg font-bold">Delete Account</h2>
      </div>
  
      <div>

        <p>Are you sure you want to permanently delete your account? <span class="text-red-400">This action cannot be undone.</span></p>

        <div class="flex justify-end gap-2 mt-4">
          <button
            type="button"
            class="px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition cursor-pointer"
            (click)="closeModal()"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-700 transition cursor-pointer"
          >
            Confirm
          </button>
        </div>
      </div>
    </div>
  </ng-template>
  